<!DOCTYPE html>
<html>
<head>
  <title>HotLogo @ WebMSX</title>
  <meta charset="UTF-8">
  <link rel="shortcut icon" type="image/x-icon" href="https://github.com/arkanon/arkanon.github.io/blob/master/favicon.ico?raw=true">

  <base href="https://rawgit.com/ppeccin/WebMSX/master/">

  <script>

    // <http://trevweb.me.uk/javascripthtml-synchronous-and-asynchronous-loading/>
    function loadjs(url)
    {
      var req = new XMLHttpRequest()
      req.open("GET", url, false) // 'false': synchronous
      req.send(null)
      var script = document.createElement('script')
      script.text = req.responseText
      document.head.appendChild(script)
      var count = typeof n === 'undefined' ? '' : ' '.repeat(N.toString().length-n.toString().length)+n+' / '+N+' '
      console.log('SCRIPT '+count+'loaded  --  '+url)
     }

    module = new Object()
    loadjs('gruntfile.js')
    str = module.exports.toString()
    str = str.slice( str.indexOf("{") + 1 , str.lastIndexOf("}") + 0 )
    str = str.slice( str.indexOf("{") + 1 , str.lastIndexOf("}") + 0 )
    str = str.slice( str.indexOf("{") + 1 , str.lastIndexOf("}") + 0 )
    str = str.slice( str.indexOf("{") + 1 , str.lastIndexOf("}") + 0 )
    str = str.slice( str.indexOf("[") + 0 , str.    indexOf("]") + 1 )
    arr = JSON.parse(str)
    arr.splice(0, 0, 'src/main/WMSX.js');
    n = 1
    N = arr.length
    for (i in arr) { loadjs(arr[i]); n++ }



    snippet = {
                'set' : 'preto no branco'

              , 'Nenhum'          : ''
              , 'ocr'             : '\nmudecor 15 1\nmudecf 15\nmudect 1\n\nesc proporção\n\n\n\n\n\nesc " esc [ã â é í ó ú ç º π] esc "'
              , 'atat'            : 'atat todas mudecf 1 tat cada [ mudect 1+resto quem 10 mudecl quem pd quem*12 at pf 80\natt cada [ mudecf quem espere 50'
              , 'proporção'       : 'mudect 6\nmudecl 4\nesc proporção\n\nrepita 360 [ pf 1 pe 1 ]\nmudeproporção 1\nrepita 360 [ pf 1 pd 1 ]\n'
              , 'preto no branco' : 'mudecor 15 1 mudecf 15 mudect 1 mudecl 1 att'
              }

    sysrom  = {
                'set' : 'MSX1'

              , 'Nenhuma' : ''
              , 'MSX1'    : '@MSX1_NTSC.bios'
              , 'HotBit'  : 'http://msxarchive.msxinfo.net/mirrors/mep/BIOS ROMs/hotbit12.zip'
              , 'Expert'  : 'http://msxarchive.msxinfo.net/mirrors/mep/BIOS ROMs/expert11.zip'
              , 'MSX2'    : '@MSX2P_NTSC.bios'
              }

    approm  = {
                'set' : 'MSX-Logo (pt) (Hot-Logo)'

              , 'Nenhuma'                                           : ''
              , 'MSX-Logo (pt) (Hot-Logo)'                          : 'http://msxblog.es/wp-content/uploads/2009/09/msxlogo_por.zip'
              , 'MSX-Logo (en)'                                     : 'http://msxblog.es/wp-content/uploads/2009/09/msxlogo_ing.zip'
              , 'MSX-Logo (es)'                                     : 'http://msxblog.es/wp-content/uploads/2009/09/msxlogo_esp.zip'
              , 'MSX-Logo (nl)'                                     : 'http://msxblog.es/wp-content/uploads/2009/09/msxlogo_hol.zip'
              , ''                                                  : ''
              , 'MSX-BASIC'                                         : '@[MSXDOS2]v22.rom'
              , 'Ligue-se ao Expert'                                : 'http://icongames.com.br/msxfiles/apps/ligue.zip'
              , 'Antarctic Adventure'                               : 'http://romsmania.com/statics/data/MSX Computer/A-C/Antarctic Adventure.zip'
              , 'Arkanoid'                                          : 'http://romsmania.com/statics/data/MSX Computer/A-C/Arkanoid.zip'
              , 'Arkanoid II - Revenge of Doh'                      : 'http://romsmania.com/statics/data/MSX 2/Arkanoid II - Revenge of Doh (Japan).zip' // msx2
              , 'Frogger'                                           : 'http://romsmania.com/statics/data/MSX Computer/D-F/Frogger.zip'
              , 'H.E.R.O'                                           : 'http://romsmania.com/statics/data/MSX Computer/G-K/Hero.zip'
              , 'Hyper Rally'                                       : 'http://romsmania.com/statics/data/MSX Computer/G-K/Hyper Rally.zip'
              , 'Iligks Episode I - Theseus'                        : 'http://romsmania.com/statics/data/MSX Computer/P-T/Thseus.zip'
              , 'Iligks Episode IV - Iriegas (The Maze of Illegus)' : 'http://romsmania.com/statics/data/MSX Computer/G-K/Iriegas.zip'
              , 'Lode Runner'                                       : 'http://romsmania.com/statics/data/MSX Computer/L-O/Lode Runner 1.zip'
              , 'Lode Runner II'                                    : 'http://romsmania.com/statics/data/MSX Computer/L-O/Lode Runner 2.zip'
              , 'Magical Tree'                                      : 'http://romsmania.com/statics/data/MSX Computer/L-O/Magical Tree.zip'
              , 'Music Editor'                                      : 'http://romsmania.com/statics/data/MSX Computer/L-O/Music Editior.zip'
              , 'PayLoad'                                           : 'http://romsmania.com/statics/data/MSX Computer/P-T/Payload.zip'
              , 'Pitfall'                                           : 'http://romsmania.com/statics/data/MSX Computer/P-T/Pitfall.zip'
              , 'Pitfall II'                                        : 'http://romsmania.com/statics/data/MSX Computer/P-T/Pitfall 2.zip'
              , 'River Raid'                                        : 'http://romsmania.com/statics/data/MSX Computer/P-T/River Raid.zip'
              , 'Road Fighter'                                      : 'http://romsmania.com/statics/data/MSX Computer/P-T/Road Fighter.zip'
              , 'Snake-It'                                          : 'http://romsmania.com/statics/data/MSX Computer/P-T/Snake-It.zip'
              , 'Super Billiards'                                   : 'http://romsmania.com/statics/data/MSX Computer/P-T/Super Billiards.zip'
              , 'Tetris'                                            : 'http://romsmania.com/statics/data/MSX 2/Tetris (Japan).zip'
              , 'Vampire Killer'                                    : 'http://romsmania.com/statics/data/MSX 2/Vampire Killer (Japan, Europe).zip'
              }

    floppy  = {
                'set' : 'Projetos Hot-Logo'

              , 'Nenhum'            : ''
              , 'Projetos Hot-Logo' : 'https://rawgit.com/arkanon/dipohlo/gh-pages/webmsx-disk.zip'
              , ''                  : '-'
              , 'MSX-DOS 1'         : '@DOS1Boot.zip'
              , 'UZIX 1'            : 'http://uzix.sourceforge.net/uzix1.0/files/uzix1.0.zip'     // msx2
              , 'UZIX 1 Apps'       : 'http://uzix.sourceforge.net/uzix1.0/files/uzix1.0appl.zip' // msx2
              , 'UZIX 2'            : 'http://uzix.sourceforge.net/uzix2.0/files/uzix0.2.0.zip'   // msx2
              , 'Aquarela 1/2'      : 'http://msx2.org/MSX TOSEC (2009-09-27)/MSX/Various/[DSK]/Aquarela (1989)(Paulisoft Informatica)(pt)(Disk 1 of 2).zip'
              , 'Aquarela 2/2'      : 'http://msx2.org/MSX TOSEC (2009-09-27)/MSX/Various/[DSK]/Aquarela (1989)(Paulisoft Informatica)(pt)(Disk 2 of 2).zip'
              , 'Graphos III'       : 'http://msx2.org/MSX TOSEC (2009-09-27)/MSX/Various/[DSK]/Graphos III (1987)(ATI Editora)(pt)[a].zip'
              , 'Graphos III Pro'   : 'http://msx2.org/MSX TOSEC (2009-09-27)/MSX/Various/[DSK]/Graphos III Pro (1989)(ProKit)(pt)[a].zip'
              , 'MSX-Word'          : 'http://msx2.org/MSX TOSEC (2009-09-27)/MSX/Various/[DSK]/MSX-Word v3.0 (1988)(Cibertron Software)(pt).zip'
              }

    savstat = {
                'set' : 'Hot-Logo'

              , 'Nenhum'              : ''
              , 'Hot-Logo'            : 'https://rawgit.com/arkanon/dipohlo/gh-pages/webmsx-hotlogo.wst'
              , 'Hugo'                : 'https://rawgit.com/arkanon/dipohlo/gh-pages/webmsx-hotlogo-hugo.wst'
              , 'Bamba'               : 'https://rawgit.com/arkanon/dipohlo/gh-pages/webmsx-hotlogo-bamba.wst'
              , 'Tio Iri'             : 'https://rawgit.com/arkanon/dipohlo/gh-pages/webmsx-hotlogo-tioiri.wst'
              , 'Parabéns'            : 'https://rawgit.com/arkanon/dipohlo/gh-pages/webmsx-hotlogo-parabens.wst'
              , ''                    : '-'
              , 'Road Fighter Part 2' : 'https://rawgit.com/arkanon/dipohlo/gh-pages/savestate/road-2.wst'
              , 'Road Fighter Part 3' : 'https://rawgit.com/arkanon/dipohlo/gh-pages/savestate/road-3.wst'
              , 'Road Fighter Part 4' : 'https://rawgit.com/arkanon/dipohlo/gh-pages/savestate/road-4.wst'
              , 'Road Fighter Part 5' : 'https://rawgit.com/arkanon/dipohlo/gh-pages/savestate/road-5.wst'
              , 'Road Fighter Part 6' : 'https://rawgit.com/arkanon/dipohlo/gh-pages/savestate/road-6.wst'
              }

    proxy   = { /* Cross-Origin Resource Sharing free proxies */
                'set' : 'CORSify Me'

              , 'Nenhum'        : ''
              , 'CORS Anywhere' : 'https://cors-anywhere.herokuapp.com/'
              , 'CORSify Me'    : 'http://www.corsify.me/'
              , 'CORS Now'      : 'https://cors.now.sh/'
              , 'Cross Origin'  : 'http://crossorigin.me/'
              , 'Thing Proxy'   : 'https://thingproxy.freeboard.io/fetch/'
              }

    charmap = {
                'ã' : '±'
              , 'â' : ''
              , 'é' : ''
              , 'í' : '¡'
              , 'ó' : '¢'
              , 'ú' : '£'
              , 'ç' : ''
              , 'º' : '§'
              , 'π' : '¾'
              }

    dt = new Date()



 // WMSX.MACHINE               = sysrom.set.charAt(3) == '2' ? 'MSX2PA' : 'MSX1A'
 // WMSX.TOUCH_MODE            = 1
    WMSX.SCREEN_ELEMENT_ID     = 'wmsx-scr'
    WMSX.AUTO_START            = false
    WMSX.SPEED                 = 1000
    WMSX.CPU_TURBO_MODE        = 8
    WMSX.VDP_TURBO_MODE        = 9
    WMSX.AUTO_POWER_ON_DELAY   = 0
    WMSX.SCREEN_CONTROL_BAR    = 1
    WMSX.SCREEN_DEFAULT_ASPECT = 1.0
    WMSX.SCREEN_DEFAULT_SCALE  = 1.5
    WMSX.SCREEN_FILTER_MODE    = 0 // 1
    WMSX.SPRITES_DEBUG_MODE    = 1

 // WMSX.CARTRIDGE1_URL        = curl(sysrom)
 // WMSX.CARTRIDGE2_URL        = curl(approm)
 // WMSX.DISKA_FILES_URL       = curl(floppy)
 // WMSX.STATE_URL             = curl(savstat)

 // WMSX.BASIC_ENTER           = tr('dt arquivos')
 // WMSX.BASIC_ENTER           = tr(snippet[snippet.set])
 // WMSX.BASIC_TYPE            =



    function curl(addr)      { var url = typeof addr === 'object' ? addr[addr.set] : addr; return url.charAt(0) == '@' ? url : encodeURI(proxy[proxy.set]+url) }
    function load(addr,port) { port=port||0; WMSX.room.fileLoader.readFromURL(curl(addr), wmsx.FileLoader.OPEN_TYPE.AUTO, port) }
    function ktype(cmd)      { WMSX.room.keyboard.typeString(tr(cmd)) }
    function wait(ms,cmd)    { setTimeout( function(){ ktype(cmd) }, ms ) }
    function settype(type)   { WMSX.room.machine.setMachine( type.charAt(3) == '2' ? 'MSX2PA' : 'MSX1A' ); load(sysrom[type]) }

    function tr(str)
    {
      var re = new RegExp( '['+Object.keys(charmap).join('')+']', 'g' )
      return str.replace( re, function(m) { return charmap[m] } )
    }

    window.onload = function(e)
    {

      WMSX.start()

      settype(sysrom.set)
   // settype('Expert')

      load(approm)

   // settype('MSX2')
   // load(approm['Arkanoid II - Revenge of Doh'])

   // ktype(snippet[snippet.set]+'\n')
   // ktype(snippet['atat'     ]+'\n')

      load(floppy)
   // ktype('dt arquivos\n')
   // ktype('carregue "mru\n')

   // settype('MSX2')
   // load(floppy['UZIX 2'])
   // load(floppy['UZIX 1 Apps'], 1)
   // wait( 7000, 'root\nmount /dev/fd1 /mnt\nls /mnt\n/mnt/cal ' + dt.getFullYear() + ' ' + (dt.getMonth()+1) + '\n' )

   // load(floppy['Aquarela 1/2'])
   // load(floppy['Aquarela 2/2'], 1)

   // load(floppy['Graphos III'])
   // ktype('\n\nload "graphos.bas\nrun\n')

   // load(floppy['Graphos III Pro'])

   // load(floppy['MSX-Word'])

   // load(savstat)
   // load(savstat['Hugo'])
   // load(savstat['Road Fighter Part 6'])

    }



    console.log(WMSX)

  </script>

  <style>

    html,
    body
    {
      width: 100%;
      height: 100%;
    }

    body
    {
      margin: 0;
      background: #292929;
    }

    #table
    {
      display: table;
      width: 100%;
      height: 100%;
    }

    #cell
    {
      display: table-cell;
      text-align: center;
      vertical-align: middle;
    }

    #wmsx-scr,
    #wmsx-bar
    {
      border: 0 !important;
    }

  </style>

</head>

<body>

  <div id="table">
    <div id="cell">
      <div id="wmsx-scr"></div>
    </div>
  </div>

</body>

</html>
